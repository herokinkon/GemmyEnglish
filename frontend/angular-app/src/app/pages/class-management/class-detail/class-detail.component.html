<div class="class-detail">
    <div class="content">
        <mat-tab-group animationDuration="0ms" *ngIf="classInfo" class="mattabgroup">
            <mat-tab label="Class Info">
                <form>
                    <mat-grid-list cols="2" rowHeight="100px">
                        <mat-grid-tile *ngFor="let field of fields">
                            <mat-form-field>
                                <mat-label>{{field.header}}</mat-label>
                                <input
                                    *ngIf="field.field !== 'lesson' && field.field !== 'startDate' && field.field !== 'endDate' && field.field !== 'schedule' && field.field !== 'fee'"
                                    name="{{field.field}}" matInput [(ngModel)]="classInfo[field.field]"
                                    (keyup)="onChange()" required>
                                <input *ngIf="field.field == 'fee'" name="{{field.field}}" matInput
                                    [ngModel]="classInfo[field.field]" (ngModelChange)="classInfo[field.field]=$event"
                                    (keyup)="onChange()" required>
                                <input *ngIf="field.field == 'lesson'" name="{{field.field}}" matInput
                                    [ngModel]="classInfo[field.field]" (ngModelChange)="classInfo[field.field]=$event"
                                    (keyup)="calculateEndDate()" required>
                                <input *ngIf="field.field == 'startDate'" class="dateField" name="startDate" matInput
                                    [matDatepicker]="startDatepicker" [(ngModel)]="classInfo.startDate"
                                    (click)="startDatepicker.open()" required>
                                <mat-datepicker #startDatepicker (selectedChanged)="calculateEndDate()">
                                </mat-datepicker>
                                <input *ngIf="field.field == 'endDate'" class="dateField" name="endDate" matInput
                                    [matDatepicker]="endDatepicker" [(ngModel)]="classInfo.endDate" disabled>
                                <mat-datepicker #endDatepicker></mat-datepicker>
                                <mat-select *ngIf="field.field == 'schedule'" [value]="schedule" name="schedule"
                                    (valueChange)="updateSchedule($event)" multiple>
                                    <mat-option value="Monday">Monday</mat-option>
                                    <mat-option value="Tuesday">Tuesday</mat-option>
                                    <mat-option value="Wednesday">Wednesday</mat-option>
                                    <mat-option value="Thursday">Thursday</mat-option>
                                    <mat-option value="Friday">Friday</mat-option>
                                    <mat-option value="Saturday">Saturday</mat-option>
                                    <mat-option value="Sunday">Sunday</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </mat-grid-tile>
                    </mat-grid-list>
                </form>
            </mat-tab>
            <mat-tab label="Other Info">
                <mat-grid-list cols="2" rowHeight="100px">
                    <mat-grid-tile *ngFor="let field of otherInfo">
                        <mat-form-field>
                            <mat-label>{{field.header}}</mat-label>
                            <input name="{{field.field}}" matInput [(ngModel)]="classInfo[field.field]"
                                (keyup)="onChange()" required={{field.required}}>
                        </mat-form-field>
                    </mat-grid-tile>
                </mat-grid-list>
            </mat-tab>
            <mat-tab *ngIf="!isNewClass" label="Student List">
                <p-table #dt [value]="studentList" dataKey="id" [rowHover]="true" [rows]="10" [autoLayout]="true"
                    [showCurrentPageReport]="true" [paginator]="true" [filterDelay]="0">
                    <ng-template pTemplate="header">
                        <tr>
                            <th>Name</th>
                            <th>Birthday</th>
                            <th>Contact</th>
                            <th>Attendance</th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-student>
                        <tr class="ui-selectable-row">
                            <td><a [routerLink]="['/student', student.id]">{{student.fullName}}</a></td>
                            <td>{{student.birthday}}</td>
                            <td>{{student.contactNumber}}</td>
                            <td style="text-align:center">
                                <mat-checkbox class="checkbox" [(ngModel)]="student.attendance"
                                    (change)="attendanceChange()"></mat-checkbox>
                            </td>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="emptymessage">
                        <tr>
                            <td colspan="8" style="text-align:left">No students found.</td>
                        </tr>
                    </ng-template>
                </p-table>
            </mat-tab>
            <mat-tab *ngIf="!isNewClass" label="Staff List">
                <p-table #dt [value]="staffList" dataKey="id" [rowHover]="true" [rows]="10" [autoLayout]="true"
                    [showCurrentPageReport]="true" [paginator]="true" [filterDelay]="0">
                    <ng-template pTemplate="header">
                        <tr>
                            <th>Name</th>
                            <th>Birthday</th>
                            <th>Contact</th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-staff>
                        <tr class="ui-selectable-row">
                            <td><a [routerLink]="['/staff', staff.id]">{{staff.fullName}}</a></td>
                            <td>{{staff.birthday}}</td>
                            <td>{{staff.contactNumber}}</td>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="emptymessage">
                        <tr>
                            <td colspan="8" style="text-align:left">No staff found.</td>
                        </tr>
                    </ng-template>
                </p-table>
            </mat-tab>
        </mat-tab-group>
    </div>
    <div>
        <!-- <div checkAttendance>
            <mat-checkbox class="my-checkbox" [(ngModel)]="checkAttendance">Attendance</mat-checkbox>
        </div> -->
        <div mat-dialog-actions>
            <button *ngIf="!isNewClass" type="button" mat-raised-button color="warn" (click)="sendEvent(action.DELETE)">
                <mat-icon>delete</mat-icon><span>Delete</span>
            </button>
            <!-- <button [disabled]="!isClassInfoChange && !isAttendanceChange" type="button" mat-raised-button color="accent"
        (click)="closeDialog('save')">
        <mat-icon>check_circle</mat-icon><span>Save</span>
    </button> -->
            <button [disabled]="!isClassInfoChange && !isAttendanceChange" type="button" mat-raised-button
                color="accent" (click)="sendEvent(isNewClass?action.CREATE:action.EDIT)">
                <mat-icon>check_circle</mat-icon><span>Save</span>
            </button>
        </div>
    </div>
</div>